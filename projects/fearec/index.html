<!DOCTYPE html>
<html>

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Dr. Luke Hart


  | fearec

</title>
<meta name="description" content="Luke Hart's website
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous">

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css">

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%8C&lt;/text&gt;&lt;/svg&gt;">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/projects/fearec/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://cosmologyluke.github.io/">
       <span class="font-weight-bold">Dr.</span> Luke  Hart
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/cv/">
                cv
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/running/">
                running
                
              </a>
          </li>
          
          
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">fearec</h1>
    <p class="post-description">fisher eigen analyser for recombination</p>
  </header>

  <article>
    <p>Introducing <code class="language-plaintext highlighter-rouge">FEARec</code> or <code class="language-plaintext highlighter-rouge">FEARec++</code> (Fisher Eigen Analyser for Recombination) which can be used to solve a <em>functional principal component analysis</em> for problems that are closed at finite limits for generic parameter changes. In this case, the variation impacts the free-electron fraction \(X_{\rm e}\) which changes how many electrons in the early Universe are ionised from their nuclei due to the hot background of photons known now as the <em>cosmic microwave background (CMB)</em>.</p>

<p>The smooth, time (redshift) dependent variations for this fraction are then cast onto the anisotropies of the CMB. These anisotropies are tiny fluctuations in temperature across the sky which tell us how the constituents of the Universe were distributed at very early times. By reverse engineering the largest changes, using a small bit of linear algebra, we can reconfigure these functional variations in a parameter (here \(X_{\rm e}\)).</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/xe_gif.gif" alt="" title="Responses in the CMB from the free electron fraction">
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/alp_gif.gif" alt="" title="Responses in the CMB from the fine structure constant">
    </div>
</div>
<div class="caption">
    A cosmology example of deconstructing responses. The top x-axis in both plots is redshift, the measurement of how far away an object is by the shifting of its light components. These responses show how parametric variations of different epochs (or times) can have big impacts on the cosmic microwave background observables (the spectra in the lower half of these plots). On the left, we are adjusting the fraction of electrons that are untethered by hydrogen/helium nuclei and therefore highly interactive with photons. On the right, we are adjusting the fine-structure constant, and consequently the very interaction rates defining electromagnetism. Both show larger responses at a redshift \(z = 1100\), a temporal location associated with the freezing of CMB anisotropies and decoupling between photons and electrons just after the Big Bang.
</div>

<p>We can weight the responses in the CMB spectra by the relative signal-to-noise in a given observable channel (in this case, the multipoles \(\ell\) of the CMB anisotropies). Once we have seen the response of the CMB spectra, this can be quantified by a mathematical object known as a <em>Fisher matrix</em>. The weighted responses are known as Fisher matrix elements \(F_{ij}\) and once this has been constructed we can transform this matrix into the leading order dimensions with the highest responses (or highest SNR).</p>

<div class="row justify-content-sm-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/Fisher_matrix.gif" alt="" title="3D tour of the Xe Fisher matrix">
    </div>
</div>
<div class="caption">
    The 3-D topology of a typical Fisher matrix. This example shows the two axes of redshift between 300 and 2000 where the contour heights points to the strength of the Fisher element, for residual changes to the free electron fraction.
</div>
<hr>

<h3 id="code-implementation">Code implementation</h3>

<p><code class="language-plaintext highlighter-rouge">FEARec</code> uses several important aspects of programming to complete the analysis but first and foremost, it is developed in C++ to optimise for object oriented programming. In this framework, I have also developed a Makefile for console usage of the routines (once they have been further optimised for better UX). Specifically, the components of the responses in the CMB power spectra, the Fisher matrix itself and the likelihood data management project (for directly taking likelihood samples) are all held in their own classes. These classes then store as standard and then utilise the <code class="language-plaintext highlighter-rouge">Eigen</code> collection of headers which make linear algebra much simpler. This includes eigen-solver classes, An example of this is below where we generate the eigenmodes for the Fisher analysis:</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">fisher</span><span class="o">::</span><span class="n">get_modes</span><span class="p">(</span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span> <span class="o">&amp;</span><span class="n">xarr</span><span class="p">,</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span> <span class="o">&amp;</span><span class="n">eigenmodes</span><span class="p">,</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span> <span class="o">&amp;</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="kt">int</span> <span class="n">truncate</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Eigen</span><span class="o">::</span><span class="n">SelfAdjointEigenSolver</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span><span class="o">&gt;</span> <span class="n">solver</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">fisher_matrix</span><span class="p">);</span>
    <span class="n">eigenmodes</span> <span class="o">=</span> <span class="n">solver</span><span class="p">.</span><span class="n">eigenvectors</span><span class="p">().</span><span class="n">rightCols</span><span class="p">(</span><span class="n">truncate</span><span class="p">);</span>
    <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">solver</span><span class="p">.</span><span class="n">eigenvalues</span><span class="p">().</span><span class="n">tail</span><span class="p">(</span><span class="n">truncate</span><span class="p">);</span>

    <span class="n">xarr</span><span class="o">=</span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="p">(</span><span class="n">eigenmodes</span><span class="p">.</span><span class="n">rows</span><span class="p">());</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">eigenmodes</span><span class="p">.</span><span class="n">rows</span><span class="p">();</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>  <span class="p">{</span>
        <span class="kt">int</span> <span class="n">kk</span><span class="o">=</span><span class="n">utils</span><span class="o">::</span><span class="n">mult_factor</span><span class="o">*</span><span class="n">k</span><span class="p">;</span>
        <span class="n">xarr</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">utils</span><span class="o">::</span><span class="n">counter_to_redshift</span><span class="p">(</span><span class="n">kk</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// When we interpolate on a grid lower resolution than 0.5,</span>
    <span class="c1">// modes start to become destabilised within the Boltzmann code</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">utils</span><span class="o">::</span><span class="n">mode_dz</span> <span class="o">&gt;</span> <span class="mf">.5</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">utils</span><span class="o">::</span><span class="n">print_warning</span><span class="p">(</span><span class="s">"get_modes"</span><span class="p">,</span>
                           <span class="s">"Low resolution splines are difficult to constrain!"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">interp_function</span><span class="p">(</span><span class="n">xarr</span><span class="p">,</span><span class="n">eigenmodes</span><span class="p">,</span><span class="n">eigenvalues</span><span class="p">,</span><span class="n">utils</span><span class="o">::</span><span class="n">mode_dz</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">eigenvalues</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">utils</span><span class="o">::</span><span class="n">eigenvalue_errors</span><span class="p">)</span> <span class="n">eigenvalues</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here we have interpolation routines that refine the eigenmodes and print the errors according to the Kramer-Rao definition. <br>
For more details on the <code class="language-plaintext highlighter-rouge">FEARec</code> project please visit <a href="https://github.io/cosmologyluke/FEARec" target="_blank" rel="noopener noreferrer">GitHub</a> to see the latest updates on the project.</p>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    Â© Copyright 2023 Dr. Luke Hart.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

    
    
    Last updated: January 05, 2023.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
